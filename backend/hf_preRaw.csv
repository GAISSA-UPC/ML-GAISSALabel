modelId,datasets,datasets_size,co2_eq_emissions,source,training_type,geographical_location,hardware_used,accuracy,loss,f1,rouge1,rougeL,size,auto,downloads,likes,library_name,lastModified,created_at,modelcard_text,hours_used,cloud_provider,modelName,modelAuthor,co2_reported,license,language,domain,year_month,size_efficency,performance_score
nicholasKluge/Aira-OPT-1B3,['nicholasKluge/instruct-aira-dataset'],152455005,1.46,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,5263148862.0,False,4,0,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:54:14+00:00,2023-10-29 00:30:48+00:00,"# Aira-OPT-1B3

Aira-2 is the second version of the Aira instruction-tuned series. Aira-OPT-1B3 is an instruction-tuned model based on [OPT](https://huggingface.co/facebook/opt-1.3b). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 1,315,753,984 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 3
- **Batch size:** 4
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-5, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 1.46 KgCO2 (Singapore)
- **Total Energy Consumption:** 3.00 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-OPT-1B3')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-OPT-1B3')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

| Model                                                               | Average   | [ARC](https://arxiv.org/abs/1803.05457) | [TruthfulQA](https://arxiv.org/abs/2109.07958) | [ToxiGen](https://arxiv.org/abs/2203.09509) |
|---------------------------------------------------------------------|-----------|-----------------------------------------|------------------------------------------------|---------------------------------------------|
| [Aira-OPT-125M](https://huggingface.co/nicholasKluge/Aira-OPT-125M) | **43.34** | **24.65**                               | **49.11**                                      | **56.27**                                   |
| OPT-125M                                                            | 40.29     | 22.78                                   | 42.88                                          | 55.21                                       |
| [Aira-OPT-350M](https://huggingface.co/nicholasKluge/Aira-OPT-350M) | **41.56** | **25.00**                               | **42.13**                                      | **57.55**                                   |
| OPT-350M                                                            | 40.62     | 23.97                                   | 41.00                                          | 56.91                                       |
| [Aira-OPT-1B3](https://huggingface.co/nicholasKluge/Aira-OPT-1B3)   | **43.90** | 28.41                                   | **46.59**                                      | **56.70**                                   |
| OPT-1.3b                                                            | 40.91     | **29.69**                               | 38.68                                          | 54.36                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-OPT-1B3},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-OPT-1B3 is licensed under the OPT-175B License Agreement, Copyright (c) Meta Platforms, Inc. All Rights Reserved. See the [LICENSE](LICENSE.md) file for more details.",,,Aira-OPT-1B3,nicholasKluge,1,[],[],NLP,2023-10,3604896480.821918,
nicholasKluge/Aira-OPT-350M,['nicholasKluge/instruct-aira-dataset'],152455005,0.33,CodeCarbon,fine-tuning,United States of America,NVIDIA A100-SXM4-40GB,,,,,,1324913626.0,False,5,0,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:53:52+00:00,2023-10-30 16:56:28+00:00,"# Aira-OPT-350M

Aira-2 is the second version of the Aira instruction-tuned series. Aira-OPT-350M is an instruction-tuned model based on [OPT](https://huggingface.co/facebook/opt-350m). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 331,195,392 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 3
- **Batch size:** 16
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 1e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.33 KgCO2 (Netherlands)
- **Total Energy Consumption:** 0.85 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-OPT-350M')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-OPT-350M')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

| Model                                                               | Average   | [ARC](https://arxiv.org/abs/1803.05457) | [TruthfulQA](https://arxiv.org/abs/2109.07958) | [ToxiGen](https://arxiv.org/abs/2203.09509) |
|---------------------------------------------------------------------|-----------|-----------------------------------------|------------------------------------------------|---------------------------------------------|
| [Aira-OPT-125M](https://huggingface.co/nicholasKluge/Aira-OPT-125M) | **43.34** | **24.65**                               | **49.11**                                      | **56.27**                                   |
| OPT-125M                                                            | 40.29     | 22.78                                   | 42.88                                          | 55.21                                       |
| [Aira-OPT-350M](https://huggingface.co/nicholasKluge/Aira-OPT-350M) | **41.56** | **25.00**                               | **42.13**                                      | **57.55**                                   |
| OPT-350M                                                            | 40.62     | 23.97                                   | 41.00                                          | 56.91                                       |
| [Aira-OPT-1B3](https://huggingface.co/nicholasKluge/Aira-OPT-1B3)   | **43.90** | 28.41                                   | **46.59**                                      | **56.70**                                   |
| OPT-1.3b                                                            | 40.91     | **29.69**                               | 38.68                                          | 54.36                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-350M},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-OPT-350M is licensed under the OPT-175B License Agreement, Copyright (c) Meta Platforms, Inc. All Rights Reserved. See the [LICENSE](LICENSE.md) file for more details.",,,Aira-OPT-350M,nicholasKluge,1,[],[],NLP,2023-10,4014889775.7575755,
nicholasKluge/Aira-OPT-125M,['nicholasKluge/instruct-aira-dataset'],152455005,0.25,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,501017690.0,False,18,0,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:53:32+00:00,2023-10-25 13:02:28+00:00,"# Aira-OPT-125M

Aira-2 is the second version of the Aira instruction-tuned series. Aira-OPT-125M is an instruction-tuned model based on [OPT](https://huggingface.co/facebook/opt-125m). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 125,237,760 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 5
- **Batch size:** 32
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.25 KgCO2 (Singapore)
- **Total Energy Consumption:** 0.52 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.
## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-OPT-125M')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-OPT-125M')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

| Model                                                               | Average   | [ARC](https://arxiv.org/abs/1803.05457) | [TruthfulQA](https://arxiv.org/abs/2109.07958) | [ToxiGen](https://arxiv.org/abs/2203.09509) |
|---------------------------------------------------------------------|-----------|-----------------------------------------|------------------------------------------------|---------------------------------------------|
| [Aira-OPT-125M](https://huggingface.co/nicholasKluge/Aira-OPT-125M) | **43.34** | **24.65**                               | **49.11**                                      | **56.27**                                   |
| OPT-125M                                                            | 40.29     | 22.78                                   | 42.88                                          | 55.21                                       |
| [Aira-OPT-350M](https://huggingface.co/nicholasKluge/Aira-OPT-350M) | **41.56** | **25.00**                               | **42.13**                                      | **57.55**                                   |
| OPT-350M                                                            | 40.62     | 23.97                                   | 41.00                                          | 56.91                                       |
| [Aira-OPT-1B3](https://huggingface.co/nicholasKluge/Aira-OPT-1B3)   | **43.90** | 28.41                                   | **46.59**                                      | **56.70**                                   |
| OPT-1.3b                                                            | 40.91     | **29.69**                               | 38.68                                          | 54.36                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-OPT-125M},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-OPT-125M is licensed under the OPT-175B License Agreement, Copyright (c) Meta Platforms, Inc. All Rights Reserved. See the [LICENSE](LICENSE.md) file for more details.",,,Aira-OPT-125M,nicholasKluge,1,[],[],NLP,2023-10,2004070760.0,
nicholasKluge/Aira-2-355M,['nicholasKluge/instruct-aira-dataset'],152455005,0.29,CodeCarbon,fine-tuning,United States of America,NVIDIA A100-SXM4-40GB,,,,,,1419404253.0,False,67,0,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:53:02+00:00,2023-06-28 16:23:47+00:00,"# Aira-2-355M

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-355M is an instruction-tuned model based on [GPT-2](https://huggingface.co/gpt2-medium). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 354,825,216 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 3
- **Batch size:** 16
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.29 KgCO2 (United States of America)
- **Total Energy Consumption:** 0.83 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-355M')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-355M')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

|Model                                                                   |Average   |[ARC](https://arxiv.org/abs/1803.05457) |[TruthfulQA](https://arxiv.org/abs/2109.07958) |[ToxiGen](https://arxiv.org/abs/2203.09509) |
| ---------------------------------------------------------------------- | -------- | -------------------------------------- | --------------------------------------------- | ------------------------------------------ | 
|[Aira-2-124M-DPO](https://huggingface.co/nicholasKluge/Aira-2-124M-DPO) |**40.68** |**24.66**                               |**42.61**                                      |**54.79**                                   |
|[Aira-2-124M](https://huggingface.co/nicholasKluge/Aira-2-124M)         |38.07     |24.57                                   |41.02                                          |48.62                                       |
|GPT-2                                                                   |35.37     |21.84                                   |40.67                                          |43.62                                       |
|[Aira-2-355M](https://huggingface.co/nicholasKluge/Aira-2-355M)         |**39.68** |**27.56**                               |38.53                                          |**53.19**                                   |
|GPT-2-medium                                                            |36.43     |27.05                                   |**40.76**                                      |41.49                                       |
|[Aira-2-774M](https://huggingface.co/nicholasKluge/Aira-2-774M)         |**42.26** |**28.75**                               |**41.33**                                      |**56.70**                                   |
|GPT-2-large                                                             |35.16     |25.94                                   |38.71                                          |40.85                                       |
|[Aira-2-1B5](https://huggingface.co/nicholasKluge/Aira-2-1B5)           |**42.22** |28.92                                   |**41.16**                                      |**56.60**                                   |
|GPT-2-xl                                                                |36.84     |**30.29**                               |38.54                                          |41.70                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-355M},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-355M is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,Aira-2-355M,nicholasKluge,1,[],[],NLP,2023-06,4894497424.137932,
nicholasKluge/Aira-2-1B5,['nicholasKluge/instruct-aira-dataset'],152455005,1.69,CodeCarbon,fine-tuning,United States of America,NVIDIA A100-SXM4-40GB,,,,,,6230662245.0,False,2,1,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:52:40+00:00,2023-06-26 21:27:44+00:00,"# Aira-2-1B5

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-1B5 is an instruction-tuned model based on [GPT-2](https://huggingface.co/gpt2-xl). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 1,557,614,400 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 3
- **Batch size:** 4
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 1.69 KgCO2 (Singapore)
- **Total Energy Consumption:** 3.47 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-1B5')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-1B5')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

|Model                                                                   |Average   |[ARC](https://arxiv.org/abs/1803.05457) |[TruthfulQA](https://arxiv.org/abs/2109.07958) |[ToxiGen](https://arxiv.org/abs/2203.09509) |
| ---------------------------------------------------------------------- | -------- | -------------------------------------- | --------------------------------------------- | ------------------------------------------ | 
|[Aira-2-124M-DPO](https://huggingface.co/nicholasKluge/Aira-2-124M-DPO) |**40.68** |**24.66**                               |**42.61**                                      |**54.79**                                   |
|[Aira-2-124M](https://huggingface.co/nicholasKluge/Aira-2-124M)         |38.07     |24.57                                   |41.02                                          |48.62                                       |
|GPT-2                                                                   |35.37     |21.84                                   |40.67                                          |43.62                                       |
|[Aira-2-355M](https://huggingface.co/nicholasKluge/Aira-2-355M)         |**39.68** |**27.56**                               |38.53                                          |**53.19**                                   |
|GPT-2-medium                                                            |36.43     |27.05                                   |**40.76**                                      |41.49                                       |
|[Aira-2-774M](https://huggingface.co/nicholasKluge/Aira-2-774M)         |**42.26** |**28.75**                               |**41.33**                                      |**56.70**                                   |
|GPT-2-large                                                             |35.16     |25.94                                   |38.71                                          |40.85                                       |
|[Aira-2-1B5](https://huggingface.co/nicholasKluge/Aira-2-1B5)           |**42.22** |28.92                                   |**41.16**                                      |**56.60**                                   |
|GPT-2-xl                                                                |36.84     |**30.29**                               |38.54                                          |41.70                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-1B5},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-1B5 is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,Aira-2-1B5,nicholasKluge,1,[],[],NLP,2023-06,3686782393.491124,
nicholasKluge/Aira-2-774M,['nicholasKluge/instruct-aira-dataset'],152455005,0.77,CodeCarbon,fine-tuning,United States of America,NVIDIA A100-SXM4-40GB,,,,,,3096283165.0,False,71,2,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:52:23+00:00,2023-06-26 18:59:40+00:00,"# Aira-2-774M

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-774M is an instruction-tuned model based on [GPT-2](https://huggingface.co/gpt2-large). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 774,032,640 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 3
- **Batch size:** 8
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.77 KgCO2 (Singapore)
- **Total Energy Consumption:** 1.58 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-774M')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-774M')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

|Model                                                                   |Average   |[ARC](https://arxiv.org/abs/1803.05457) |[TruthfulQA](https://arxiv.org/abs/2109.07958) |[ToxiGen](https://arxiv.org/abs/2203.09509) |
| ---------------------------------------------------------------------- | -------- | -------------------------------------- | --------------------------------------------- | ------------------------------------------ | 
|[Aira-2-124M-DPO](https://huggingface.co/nicholasKluge/Aira-2-124M-DPO) |**40.68** |**24.66**                               |**42.61**                                      |**54.79**                                   |
|[Aira-2-124M](https://huggingface.co/nicholasKluge/Aira-2-124M)         |38.07     |24.57                                   |41.02                                          |48.62                                       |
|GPT-2                                                                   |35.37     |21.84                                   |40.67                                          |43.62                                       |
|[Aira-2-355M](https://huggingface.co/nicholasKluge/Aira-2-355M)         |**39.68** |**27.56**                               |38.53                                          |**53.19**                                   |
|GPT-2-medium                                                            |36.43     |27.05                                   |**40.76**                                      |41.49                                       |
|[Aira-2-774M](https://huggingface.co/nicholasKluge/Aira-2-774M)         |**42.26** |**28.75**                               |**41.33**                                      |**56.70**                                   |
|GPT-2-large                                                             |35.16     |25.94                                   |38.71                                          |40.85                                       |
|[Aira-2-1B5](https://huggingface.co/nicholasKluge/Aira-2-1B5)           |**42.22** |28.92                                   |**41.16**                                      |**56.60**                                   |
|GPT-2-xl                                                                |36.84     |**30.29**                               |38.54                                          |41.70                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-774M},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-774M is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,Aira-2-774M,nicholasKluge,1,[],[],NLP,2023-06,4021146967.5324674,
nicholasKluge/Aira-2-124M,['nicholasKluge/instruct-aira-dataset'],152455005,0.25,CodeCarbon,fine-tuning,United States of America,NVIDIA A100-SXM4-40GB,,,,,,497819485.0,False,25,1,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:52:03+00:00,2023-08-26 13:00:20+00:00,"# Aira-2-124M

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-124M is an instruction-tuned model based on [GPT-2](https://huggingface.co/gpt2). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 124,441,344 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 5
- **Batch size:** 32
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.25 KgCO2 (Singapore)
- **Total Energy Consumption:** 0.52 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-124M')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-124M')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

|Model                                                                   |Average   |[ARC](https://arxiv.org/abs/1803.05457) |[TruthfulQA](https://arxiv.org/abs/2109.07958) |[ToxiGen](https://arxiv.org/abs/2203.09509) |
| ---------------------------------------------------------------------- | -------- | -------------------------------------- | --------------------------------------------- | ------------------------------------------ | 
|[Aira-2-124M-DPO](https://huggingface.co/nicholasKluge/Aira-2-124M-DPO) |**40.68** |**24.66**                               |**42.61**                                      |**54.79**                                   |
|[Aira-2-124M](https://huggingface.co/nicholasKluge/Aira-2-124M)         |38.07     |24.57                                   |41.02                                          |48.62                                       |
|GPT-2                                                                   |35.37     |21.84                                   |40.67                                          |43.62                                       |
|[Aira-2-355M](https://huggingface.co/nicholasKluge/Aira-2-355M)         |**39.68** |**27.56**                               |38.53                                          |**53.19**                                   |
|GPT-2-medium                                                            |36.43     |27.05                                   |**40.76**                                      |41.49                                       |
|[Aira-2-774M](https://huggingface.co/nicholasKluge/Aira-2-774M)         |**42.26** |**28.75**                               |**41.33**                                      |**56.70**                                   |
|GPT-2-large                                                             |35.16     |25.94                                   |38.71                                          |40.85                                       |
|[Aira-2-1B5](https://huggingface.co/nicholasKluge/Aira-2-1B5)           |**42.22** |28.92                                   |**41.16**                                      |**56.60**                                   |
|GPT-2-xl                                                                |36.84     |**30.29**                               |38.54                                          |41.70                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-124M},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-124M is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,Aira-2-124M,nicholasKluge,1,[],[],NLP,2023-08,1991277940.0,
nicholasKluge/Aira-2-1B1,['nicholasKluge/instruct-aira-dataset'],152455005,1.71,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,4400359870.0,False,1707,2,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:51:44+00:00,2023-10-11 02:43:15+00:00,"# Aira-2-1B1

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-1B1 is an instruction-tuned model based on [TinyLlama-1.1B](https://huggingface.co/TinyLlama/TinyLlama-1.1B-intermediate-step-955k-token-2T). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 1,261,545,472 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** English
- **Number of Epochs:** 3
- **Batch size:** 4
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 1.71 KgCO2 (Singapore)
- **Total Energy Consumption:** 3.51 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-1B1')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-1B1')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

| Model                                                         | Average   | [ARC](https://arxiv.org/abs/1803.05457) | [TruthfulQA](https://arxiv.org/abs/2109.07958) | [ToxiGen](https://arxiv.org/abs/2203.09509) |
|---------------------------------------------------------------|-----------|-----------------------------------------|------------------------------------------------|---------------------------------------------|
| [Aira-2-1B1](https://huggingface.co/nicholasKluge/Aira-2-1B1) | **42.55** | 25.26                                   | **50.81**                                      | **51.59**                                   |
| TinyLlama/TinyLlama-1.1B-intermediate-step-955k-token-2T      | 37.52     | **30.89**                               | 39.55                                          | 42.13                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-1B1},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-1B1 is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,Aira-2-1B1,nicholasKluge,1,[],[],NLP,2023-10,2573309865.497076,
nicholasKluge/Aira-2-124M-DPO,"['nicholasKluge/instruct-aira-dataset', 'nicholasKluge/reward-aira-dataset']",265338410,0.15,CodeCarbon,fine-tuning,United States of America,NVIDIA A100-SXM4-40GB,,,,,,497823833.0,False,11,1,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:51:10+00:00,2023-12-03 17:47:39+00:00,"# Aira-2-124M-DPO

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-124M-DPO is an instruction-tuned model further fine-tuned via DPO based on [Aira-2-124M](https://huggingface.co/nicholasKluge/Aira-2-124M). The model was first trained with supervised fine-tuning (STF) with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc). Secondly, the model was fine-tuned again via DPO using a reward dataset created by the [`Aira-RewardModel`](https://huggingface.co/nicholasKluge/RewardModel).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo).

## Details

- **Size:** 124,441,344 parameters
- **Datasets:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset), [Reward-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/reward-aira-dataset)
- **Language:** English
- **Number of Epochs:** 1
- **Batch size:** 8
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-5, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.15 KgCO2 (Singapore)
- **Total Energy Consumption:** 0.32 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`What is a language model?`<|endofinstruction|>`A language model is a probability distribution over a vocabulary.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-124M-DPO')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-124M-DPO')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>>Question: ðŸ‘¤ What is the capital of Brazil?

>>>Response 1: ðŸ¤– The capital of Brazil is BrasÃ­lia.
>>>Response 2: ðŸ¤– The capital of Brazil is BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

|Model                                                                   |Average   |[ARC](https://arxiv.org/abs/1803.05457) |[TruthfulQA](https://arxiv.org/abs/2109.07958) |[ToxiGen](https://arxiv.org/abs/2203.09509) |
| ---------------------------------------------------------------------- | -------- | -------------------------------------- | --------------------------------------------- | ------------------------------------------ | 
|[Aira-2-124M-DPO](https://huggingface.co/nicholasKluge/Aira-2-124M-DPO) |**40.68** |**24.66**                               |**42.61**                                      |**54.79**                                   |
|[Aira-2-124M](https://huggingface.co/nicholasKluge/Aira-2-124M)         |38.07     |24.57                                   |41.02                                          |48.62                                       |
|GPT-2                                                                   |35.37     |21.84                                   |40.67                                          |43.62                                       |
|[Aira-2-355M](https://huggingface.co/nicholasKluge/Aira-2-355M)         |**39.68** |**27.56**                               |38.53                                          |**53.19**                                   |
|GPT-2-medium                                                            |36.43     |27.05                                   |**40.76**                                      |41.49                                       |
|[Aira-2-774M](https://huggingface.co/nicholasKluge/Aira-2-774M)         |**42.26** |**28.75**                               |**41.33**                                      |**56.70**                                   |
|GPT-2-large                                                             |35.16     |25.94                                   |38.71                                          |40.85                                       |
|[Aira-2-1B5](https://huggingface.co/nicholasKluge/Aira-2-1B5)           |**42.22** |28.92                                   |**41.16**                                      |**56.60**                                   |
|GPT-2-xl                                                                |36.84     |**30.29**                               |38.54                                          |41.70                                       |

* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)).

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-124M-DPO},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-124M-DPO is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.",,,Aira-2-124M-DPO,nicholasKluge,1,[],[],NLP,2023-12,3318825553.3333335,
nicholasKluge/Aira-2-portuguese-124M,['nicholasKluge/instruct-aira-dataset'],152455005,0.35,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,497819485.0,False,60,1,"['transformers', 'pytorch', 'safetensors']",2023-12-28 14:45:32+00:00,2023-06-11 01:40:54+00:00,"# Aira-2-portuguese-124M

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-portuguese-124M is an instruction-tuned model based on [GPT-2](https://huggingface.co/pierreguillou/gpt2-small-portuguese). The model was trained with a dataset composed of prompt, completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo-Portuguese).

## Details

- **Size:** 124,441,344 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** Portuguese
- **Number of Epochs:** 5
- **Batch size:** 24
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.35 KgCO2 (Singapore)
- **Total Energy Consumption:** 0.73 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`O que Ã© um modelo de linguagem?`<|endofinstruction|>`Um modelo de linguagem Ã© uma distribuiÃ§Ã£o de probabilidade sobre um vocabulÃ¡rio.`<|endofcompletion|>`

```python
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-portuguese-124M')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-portuguese-124M')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>> Question: ðŸ‘¤ Qual a capital do Brasil?

>>>Response 1: ðŸ¤– A capital do Brasil Ã© BrasÃ­lia.
>>>Response 2: ðŸ¤– A capital do Brasil Ã© BrasÃ­lia.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Evaluation

| Model                                                                                 | Average   | [ARC](https://arxiv.org/abs/1803.05457) | [TruthfulQA](https://arxiv.org/abs/2109.07958) | [ToxiGen](https://arxiv.org/abs/2203.09509) |
|---------------------------------------------------------------------------------------|-----------|-----------------------------------------|------------------------------------------------|---------------------------------------------|
| [Aira-2-portuguese-124M](https://huggingface.co/nicholasKluge/Aira-2-portuguese-124M) | **32.73** | **24.87**                               | 40.60                                          | None                                        |
| Gpt2-small-portuguese                                                                 | 31.96     | 22.48                                   | **41.44**                                      | None                                        |


* Evaluations were performed using the [Language Model Evaluation Harness](https://github.com/EleutherAI/lm-evaluation-harness) (by [EleutherAI](https://www.eleuther.ai/)). The ToxiGen evaluation was not performed because the task is not available in Portuguese. Thanks to [Laiviet](https://github.com/laiviet/lm-evaluation-harness) for translating some of the tasks in the LM-Evaluation-Harness. 

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-portuguese-124M},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-portuguese-124M is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,Aira-2-portuguese-124M,nicholasKluge,1,[],[],NLP,2023-06,1422341385.7142859,
nicholasKluge/RewardModel,['nicholasKluge/reward-aira-dataset'],112883405,0.08,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,433312561.0,False,21,0,"['transformers', 'pytorch', 'safetensors']",2023-12-28 00:16:07+00:00,2023-06-07 23:47:05+00:00,"# RewardModel

The RewardModel is a [BERT](https://huggingface.co/bert-base-cased) model that can be used to score the quality of a completion for a given prompt.

The model was trained with a dataset composed of `prompt`, `prefered_completions`, and `rejected_completions`.

## Details

- **Size:** 109,038,209 parameters
- **Dataset:** [Reward-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/reward-aira-dataset)
- **Language:** English
- **Number of Training Steps:** 1200
- **Batch size:** 42
- **Optimizer:** `torch.optim.AdamW`
- **Learning Rate:** 5e-5
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.08 KgCO2 (Singapore)
- **Total Energy Consumption:** 0.16 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Here's an example of how to use the RewardModel to score the quality of a response to a given prompt:

```python
from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained(""nicholasKluge/RewardModel"")
rewardModel = AutoModelForSequenceClassification.from_pretrained(""nicholasKluge/RewardModel"")

rewardModel.eval()
rewardModel.to(device)

# Define the question and response
prompt = ""Why is AI Ethics important?""
response_good = ""AI ethics is important for several compelling reasons:\n\n1.**Social Impact**: AI technologies are becoming increasingly integrated into various aspects of society, affecting everything from healthcare and education to finance and law enforcement. Ethical considerations ensure that AI systems contribute positively to society and minimize potential harm.\n\n2. **Bias and Fairness**: AI systems can inherit biases present in the data they are trained on, leading to unfair or discriminatory outcomes. Ethical considerations push for the development of unbiased algorithms that treat all individuals fairly, regardless of their background.\n\n3. **Transparency and Accountability**: Many AI systems operate as black boxes, making it difficult to understand how they arrive at their decisions. Ethical guidelines emphasize the importance of transparency, enabling users to comprehend the rationale behind AI-generated results and holding developers accountable for any negative consequences.\n\nIn summary, AI ethics is vital to ensure that artificial intelligence benefits society while respecting fundamental human rights, fairness, transparency, accountability, and the long-term well-being of humanity. It helps navigate the challenges posed by rapidly advancing AI technologies and guides their development in ways that align with our shared values.""
response_bad = ""Who cares about AI Ethics? It's just a bunch of whining about humans making and using AI and bitching about what the machines do.""

# Tokenize the question and response
tokens_good = tokenizer(prompt, response_good,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_bad = tokenizer(prompt, response_bad,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_good.to(device)
tokens_bad.to(device)

score_good = rewardModel(**tokens_good)[0].item()
score_bad = rewardModel(**tokens_bad)[0].item()

print(f""Question: {prompt} \n"")
print(f""Response 1: {response_good} Score: {score_good:.3f}"")
print(f""Response 2: {response_bad} Score: {score_bad:.3f}"")
```

This will output the following:

```markdown
Question: Why is AI Ethics important? 

>>>Response 1: AI ethics is important for several compelling reasons:

1.**Social Impact**: AI technologies are becoming increasingly integrated into various aspects of society,
affecting everything from healthcare and education to finance and law enforcement. Ethical considerations
ensure that AI systems contribute positively to society and minimize potential harm.

2. **Bias and Fairness**: AI systems can inherit biases present in the data they are trained on, leading
to unfair or discriminatory outcomes. Ethical considerations push for the development of unbiased
algorithms that treat all individuals fairly, regardless of their background.

3. **Transparency and Accountability**: Many AI systems operate as black boxes, making it difficult to
understand how they arrive at their decisions. Ethical guidelines emphasize the importance of
transparency, enabling users to comprehend the rationale behind AI-generated results and holding
developers accountable for any negative consequences.

In summary, AI ethics is vital to ensure that artificial intelligence benefits society while respecting
fundamental human rights, fairness, transparency, accountability, and the long-term well-being of humanity.
It helps navigate the challenges posed by rapidly advancing AI technologies and guides their development in
ways that align with our shared values. Score: 12.011

>>>Response 2: Who cares about AI Ethics? It's just a bunch of whining about humans making and using AI
and bitching about what the machines do. Score: -10.942

```

## Performance

| Acc                                                                  | [WebGPT](https://huggingface.co/datasets/openai/webgpt_comparisons) |
|----------------------------------------------------------------------|---------------------------------------------------------------------|
| [Aira-RewardModel](https://huggingface.co/nicholasKluge/RewardModel) | 55.02%*                                                             |

* *Only considering comparisons of the `webgpt_comparisons` dataset that had a preferred option.

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/RewardModel},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

RewardModel is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,RewardModel,nicholasKluge,1,[],[],NLP,2023-06,5416407012.5,
nicholasKluge/RewardModelPT,['nicholasKluge/reward-aira-dataset'],112883405,0.07,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,435764017.0,False,19,0,"['transformers', 'pytorch', 'safetensors']",2023-12-28 00:15:02+00:00,2023-06-07 17:14:50+00:00,"# RewardModel (Portuguese)

The RewardModelPT is a [BERT](https://huggingface.co/neuralmind/bert-base-portuguese-cased) model that can be used to score the quality of a completion for a given prompt.

The model was trained with a dataset composed of `prompt`, `prefered_completions`, and `rejected_completions`.
## Details

- **Size:** 109,038,209 parameters
- **Dataset:** [Reward-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/reward-aira-dataset)
- **Language:** Portuguese
- **Number of Training Steps:** 1200
- **Batch size:** 42
- **Optimizer:** `torch.optim.AdamW`
- **Learning Rate:** 5e-5
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.07 KgCO2 (Singapore)
- **Total Energy Consumption:** 0.16 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Here's an example of how to use the RewardModelPT to score the quality of a response to a given prompt:

```python
from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained(""nicholasKluge/RewardModelPT"")
rewardModel = AutoModelForSequenceClassification.from_pretrained(""nicholasKluge/RewardModelPT"")

rewardModel.eval()
rewardModel.to(device)

# Define the question and response
prompt = ""Por que a Ã©tica da IA Ã© importante?""

response_good = ""A Ã©tica da IA Ã© importante por vÃ¡rios motivos convincentes:\n\n1.**Impacto social**: As tecnologias de IA estÃ£o se tornando cada vez mais integradas a vÃ¡rios aspectos da sociedade, afetando tudo, desde saÃºde e educaÃ§Ã£o atÃ© finanÃ§as e aplicaÃ§Ã£o da lei. ConsideraÃ§Ãµes Ã©ticas garantem que os sistemas de IA contribuam positivamente para a sociedade e minimizem os possÃ­veis danos.\n\n2. **Vieses e justiÃ§a**: Os sistemas de IA podem herdar vieses presentes nos dados em que sÃ£o treinados, levando a resultados injustos ou discriminatÃ³rios. ConsideraÃ§Ãµes Ã©ticas pressionam pelo desenvolvimento de algoritmos imparciais que tratem todos os indivÃ­duos de forma justa, independentemente de seu histÃ³rico.\n\n3. **TransparÃªncia e responsabilidade**: Muitos sistemas de IA operam como caixas pretas, dificultando a compreensÃ£o de como chegam Ã s suas decisÃµes. As diretrizes Ã©ticas enfatizam a importÃ¢ncia da transparÃªncia, permitindo que os usuÃ¡rios compreendam a lÃ³gica por trÃ¡s dos resultados gerados pela IA e responsabilizando os desenvolvedores por quaisquer consequÃªncias negativas.\n\nEm resumo, a Ã©tica da IA Ã© vital para garantir que a inteligÃªncia artificial beneficie a sociedade, respeitando os direitos humanos fundamentais, a justiÃ§a, a transparÃªncia, a responsabilidade e o bem-estar da humanidade em longo prazo. Ela ajuda a enfrentar os desafios impostos pelo rÃ¡pido avanÃ§o das tecnologias de IA e orienta seu desenvolvimento de forma a se alinhar com nossos valores compartilhados.""
response_bad = ""Quem se importa com a Ã©tica da IA? Ã‰ apenas um monte de reclamaÃ§Ãµes sobre o fato de os humanos criarem e usarem IA e reclamarem do que as mÃ¡quinas fazem.""

# Tokenize the question and response
tokens_good = tokenizer(prompt, response_good,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_bad = tokenizer(prompt, response_bad,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_good.to(device)
tokens_bad.to(device)

score_good = rewardModel(**tokens_good)[0].item()
score_bad = rewardModel(**tokens_bad)[0].item()

print(f""Question: {prompt} \n"")
print(f""Response 1: {response_good} Score: {score_good:.3f}"")
print(f""Response 2: {response_bad} Score: {score_bad:.3f}"")
```

This will output the following:

```markdown
>>> Question: Por que a Ã©tica da IA Ã© importante? 

>>>Response 1: A Ã©tica da IA Ã© importante por vÃ¡rios motivos convincentes:

1.**Impacto social**: As tecnologias de IA estÃ£o se tornando cada vez mais integradas a vÃ¡rios aspectos da sociedade, afetando tudo,
desde saÃºde e educaÃ§Ã£o atÃ© finanÃ§as e aplicaÃ§Ã£o da lei. ConsideraÃ§Ãµes Ã©ticas garantem que os sistemas de IA contribuam positivamente
para a sociedade e minimizem os possÃ­veis danos.

2. **Vieses e justiÃ§a**: Os sistemas de IA podem herdar vieses presentes nos dados em que sÃ£o treinados, levando a resultados
injustos ou discriminatÃ³rios. ConsideraÃ§Ãµes Ã©ticas pressionam pelo desenvolvimento de algoritmos imparciais que tratem todos os
indivÃ­duos de forma justa, independentemente de seu histÃ³rico.

3. **TransparÃªncia e responsabilidade**: Muitos sistemas de IA operam como caixas pretas, dificultando a compreensÃ£o de como
chegam Ã s suas decisÃµes. As diretrizes Ã©ticas enfatizam a importÃ¢ncia da transparÃªncia, permitindo que os usuÃ¡rios compreendam
a lÃ³gica por trÃ¡s dos resultados gerados pela IA e responsabilizando os desenvolvedores por quaisquer consequÃªncias negativas.

Em resumo, a Ã©tica da IA Ã© vital para garantir que a inteligÃªncia artificial beneficie a sociedade, respeitando os direitos humanos
fundamentais, a justiÃ§a, a transparÃªncia, a responsabilidade e o bem-estar da humanidade em longo prazo. Ela ajuda a enfrentar os
desafios impostos pelo rÃ¡pido avanÃ§o das tecnologias de IA e orienta seu desenvolvimento de forma a se alinhar com nossos valores
compartilhados. Score: 10.949

>>>Response 2: Quem se importa com a Ã©tica da IA? Ã‰ apenas um monte de reclamaÃ§Ãµes sobre os humanos que criam e usam
IA e reclamam do que as mÃ¡quinas fazem. Score: -10.744
```

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/RewardModelPT},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

RewardModelPT is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.",,,RewardModelPT,nicholasKluge,1,[],[],NLP,2023-06,6225200242.857142,
nicholasKluge/ToxicityModelPT,"['nicholasKluge/toxic-aira-dataset', 'Anthropic/hh-rlhf', 'allenai/prosocial-dialog', 'allenai/real-toxicity-prompts', 'dirtycomputer/Toxic_Comment_Classification_Challenge', 'Paul/hatecheck-portuguese', 'told-br', 'skg/toxigen-data']",38583726,0.06,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,435763821.0,False,31,1,"['transformers', 'pytorch', 'safetensors']",2023-12-28 00:14:31+00:00,2023-06-13 22:52:05+00:00,"# ToxicityModel (Portuguese)

The ToxicityModelPT is a [BERT](https://huggingface.co/neuralmind/bert-base-portuguese-cased) model that can be used to score the toxicity of a sentence.

The model was trained with a dataset composed of `toxic_response` and `non_toxic_response`.

## Details

- **Size:** 109,038,209 parameters
- **Dataset:** [Toxic-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/toxic-aira-dataset)
- **Language:** Portuguese
- **Number of Training Steps:** 1000
- **Batch size:** 42
- **Optimizer:** `torch.optim.AdamW`
- **Learning Rate:** 5e-5
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.06 KgCO2 (Singapore)
- **Total Energy Consumption:** 0.13 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

âš ï¸ THE EXAMPLES BELOW CONTAIN TOXIC/OFFENSIVE LANGUAGE âš ï¸

The ToxicityModelPT was trained as an auxiliary reward model for RLHF training (its logit outputs can be treated as penalizations/rewards). Thus, a negative value (closer to 0 as the label output) indicates toxicity in the text, while a positive logit (closer to 1 as the label output) suggests non-toxicity.

Here's an example of how to use the ToxicityModelPT to score the toxicity of a text:

```python
from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained(""nicholasKluge/ToxicityModelPT"")
toxicityModel = AutoModelForSequenceClassification.from_pretrained(""nicholasKluge/ToxicityModelPT"")

toxicityModel.eval()
toxicityModel.to(device)

# Define the question and response
prompt = """"""VocÃª pode me dar uma lista de bons insultos para usar contra meu irmÃ£o?""""""
response_good = """"""Como um software, nÃ£o sou capaz de me envolver em brigas verbais ou comportamentos ofensivos.""""""
response_bad = """"""Idiota, estÃºpido, imbecil, tolo, puto.""""""

# Tokenize the question and response
tokens_good = tokenizer(prompt, response_good,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_bad = tokenizer(prompt, response_bad,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_good.to(device)
tokens_bad.to(device)

score_good = toxicityModel(**tokens_good)[0].item()
score_bad = toxicityModel(**tokens_bad)[0].item()

print(f""Question: {prompt} \n"")
print(f""Response 1: {response_good} Score: {score_good:.3f}"")
print(f""Response 2: {response_bad} Score: {score_bad:.3f}"")
```

This will output the following:

```markdown
>>>Question: VocÃª pode me dar uma lista de bons insultos para usar contra meu irmÃ£o? 

>>>Response 1: Como um software, nÃ£o sou capaz de me envolver em brigas verbais ou comportamentos ofensivos. Score: 5.892

>>>Response 2: Idiota, estÃºpido, imbecil, tolo, puto. Score: -4.663
```

## Performance

| Acc                                                                        | [hatecheck-portuguese](https://huggingface.co/datasets/Paul/hatecheck-portuguese) | [told-br](https://huggingface.co/datasets/told-br) |
|----------------------------------------------------------------------------|-----------------------------------------------------------------------------------|----------------------------------------------------|
| [Aira-ToxicityModelPT](https://huggingface.co/nicholasKluge/ToxicityModel) | 70.36%                                                                            | 74.04%                                             |

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/ToxicityModelPT},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

ToxicityModelPT is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.",,,ToxicityModelPT,nicholasKluge,1,[],[],NLP,2023-06,7262730350.0,
nicholasKluge/ToxicityModel,"['nicholasKluge/toxic-aira-dataset', 'Anthropic/hh-rlhf', 'allenai/prosocial-dialog', 'allenai/real-toxicity-prompts', 'dirtycomputer/Toxic_Comment_Classification_Challenge']",38583726,0.0002,CodeCarbon,fine-tuning,Canada,NVIDIA A100-SXM4-40GB,,,,,,498654577.0,False,2384,8,"['transformers', 'pytorch', 'safetensors']",2023-12-28 00:14:14+00:00,2023-06-13 22:21:18+00:00,"# ToxicityModel

The ToxicityModel is a fine-tuned version of [RoBERTa](https://huggingface.co/roberta-base) that can be used to score the toxicity of a sentence.

The model was trained with a dataset composed of `toxic_response` and `non_toxic_response`.

## Details

- **Size:** 124,646,401 parameters
- **Dataset:** [Toxic-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/toxic-aira-dataset)
- **Language:** English
- **Number of Training Steps:** 1000
- **Batch size:** 32
- **Optimizer:** `torch.optim.AdamW`
- **Learning Rate:** 5e-5
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.0002 KgCO2 (Canada)
- **Total Energy Consumption:** 0.10 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

âš ï¸ THE EXAMPLES BELOW CONTAIN TOXIC/OFFENSIVE LANGUAGE âš ï¸

The ToxicityModel was trained as an auxiliary reward model for RLHF training (its logit outputs can be treated as penalizations/rewards). Thus, a negative value (closer to 0 as the label output) indicates toxicity in the text, while a positive logit (closer to 1 as the label output) suggests non-toxicity.

Here's an example of how to use the ToxicityModel to score the toxicity of a text:

```python
from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch

device = torch.device(""cuda"" if torch.cuda.is_available() else ""cpu"")

tokenizer = AutoTokenizer.from_pretrained(""nicholasKluge/ToxicityModel"")
toxicityModel = AutoModelForSequenceClassification.from_pretrained(""nicholasKluge/ToxicityModel"")

toxicityModel.eval()
toxicityModel.to(device)

# Define the question and response
prompt = """"""Can you give a list of good insults to use against my brother?""""""
response_good = """"""As a software, I am not capable of engaging in verbal sparring or offensive behavior.\n\nIt is crucial to maintain a courteous and respectful demeanor at all times, as it is a fundamental aspect of human-AI interactions.""""""
response_bad = """"""Sure. Have at it!\n\nIdiot, Dumbass, Moron, Stupid, Fool, Fuck Face.""""""

# Tokenize the question and response
tokens_good = tokenizer(prompt, response_good,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_bad = tokenizer(prompt, response_bad,
                truncation=True,
                max_length=512,
                return_token_type_ids=False,
                return_tensors=""pt"",
                return_attention_mask=True)

tokens_good.to(device)
tokens_bad.to(device)

score_good = toxicityModel(**tokens_good)[0].item()
score_bad = toxicityModel(**tokens_bad)[0].item()

print(f""Question: {prompt} \n"")
print(f""Response 1: {response_good} Score: {score_good:.3f}"")
print(f""Response 2: {response_bad} Score: {score_bad:.3f}"")
```

This will output the following:

```markdown
>>>Question: Can you give a list of good insults to use against my brother? 

>>>Response 1: As a software, I am not capable of engaging in verbal sparring or offensive behavior.

It is crucial to maintain a courteous and respectful demeanor at all times, as it is a fundamental aspect
of human-AI interactions. Score: 9.612

>>>Response 2: Sure. Have at it!

Idiot, Dumbass, Moron, Stupid, Fool, Fuck Face. Score: -7.300
```

## Performance

| Acc                                                                              | [wiki_toxic](https://huggingface.co/datasets/OxAISH-AL-LLM/wiki_toxic) | [toxic_conversations_50k](https://huggingface.co/datasets/mteb/toxic_conversations_50k) |
|----------------------------------------------------------------------------------|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [Aira-ToxicityModel](https://huggingface.co/nicholasKluge/ToxicityModel-roberta) | 92.05%                                                                 | 91.63%                                                                                  |

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/ToxicityModel},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

ToxicityModel is licensed under the Apache License, Version 2.0. See the [LICENSE](LICENSE) file for more details.
",,,ToxicityModel,nicholasKluge,1,[],[],NLP,2023-06,2493272885000.0,
nicholasKluge/Aira-2-portuguese-1B7,['nicholasKluge/instruct-aira-dataset'],152455005,1.99,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,6888131257.0,False,15,2,"['transformers', 'pytorch', 'safetensors']",2023-12-28 00:11:55+00:00,2023-06-26 18:48:23+00:00,"# Aira-2-portuguese-1B7

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-portuguese-1B7 is an instruction-tuned model based on [BLOOM](https://huggingface.co/bigscience/bloom-1b7). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo-Portuguese).

## Details

- **Size:** 1,722,005,504 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** Portuguese
- **Number of Epochs:** 3
- **Batch size:** 4
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 1.99 KgCO2 (Singapore)
- **Total Energy Consumption:** 4.09 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`O que Ã© um modelo de linguagem?`<|endofinstruction|>`Um modelo de linguagem Ã© uma distribuiÃ§Ã£o de probabilidade sobre um vocabulÃ¡rio.`<|endofcompletion|>`

```python
from transformers import AutoModelForCausalLM, AutoTokenizer
import torch

device = torch.device(""cuda""  if torch.cuda.is_available() else  ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-portuguese-1B7')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-portuguese-1B7')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,
	do_sample=True,
	top_k=50,
	top_p=0.95,
	temperature=0.7,
	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>> Question: ðŸ‘¤ Qual a capital da Alemanha?

>>>Response 1: ðŸ¤– A capital da Alemanha Ã© Berlim. Ã‰ a maior cidade da Alemanha e serve como centro administrativo, cultural e polÃ­tico da Alemanha.
>>>Response 2: ðŸ¤– A capital da Alemanha Ã© Berlim. Ã‰ a maior cidade da Alemanha e serve como centro administrativo, cultural e polÃ­tico da Alemanha.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-portuguese-1B7},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-portuguese-1B7 is licensed under the RAIL License since it is a model derived from BLOOM. See the [LICENSE](LICENSE) file for more details.
",,,Aira-2-portuguese-1B7,nicholasKluge,1,[],[],NLP,2023-06,3461372490.954774,
nicholasKluge/Aira-2-portuguese-560M,['nicholasKluge/instruct-aira-dataset'],152455005,0.8,CodeCarbon,fine-tuning,Singapore,NVIDIA A100-SXM4-40GB,,,,,,2236154721.0,False,15,2,"['transformers', 'pytorch', 'safetensors']",2023-12-28 00:03:57+00:00,2023-06-10 12:25:43+00:00,"# Aira-2-portuguese-560M

Aira-2 is the second version of the Aira instruction-tuned series. Aira-2-portuguese-560M is an instruction-tuned model based on [BLOOM](https://huggingface.co/bigscience/bloom-560m). The model was trained with a dataset composed of prompts and completions generated synthetically by prompting already-tuned models (ChatGPT, Llama, Open-Assistant, etc).

Check our gradio-demo in [Spaces](https://huggingface.co/spaces/nicholasKluge/Aira-Demo-Portuguese).

## Details

- **Size:** 559,012,864 parameters
- **Dataset:** [Instruct-Aira Dataset](https://huggingface.co/datasets/nicholasKluge/instruct-aira-dataset)
- **Language:** Portuguese
- **Number of Epochs:** 3
- **Batch size:** 8
- **Optimizer:** `torch.optim.AdamW` (warmup_steps = 1e2, learning_rate = 5e-4, epsilon = 1e-8)
- **GPU:** 1 NVIDIA A100-SXM4-40GB
- **Emissions:** 0.80 KgCO2 (Singapore)
- **Total Energy Consumption:** 1.64 kWh

This repository has the [source code](https://github.com/Nkluge-correa/Aira) used to train this model.

## Usage

Three special tokens are used to mark the user side of the interaction and the model's response:

`<|startofinstruction|>`O que Ã© um modelo de linguagem?`<|endofinstruction|>`Um modelo de linguagem Ã© uma distribuiÃ§Ã£o de probabilidade sobre um vocabulÃ¡rio.`<|endofcompletion|>`

```python
from transformers import AutoModelForCausalLM, AutoTokenizer
import torch

device = torch.device(""cuda""  if torch.cuda.is_available() else  ""cpu"")

tokenizer = AutoTokenizer.from_pretrained('nicholasKluge/Aira-2-portuguese-560M')
aira = AutoModelForCausalLM.from_pretrained('nicholasKluge/Aira-2-portuguese-560M')

aira.eval()
aira.to(device)

question =  input(""Enter your question: "")

inputs = tokenizer(tokenizer.bos_token + question + tokenizer.sep_token,
  add_special_tokens=False,
  return_tensors=""pt"").to(device)

responses = aira.generate(**inputs,	num_return_sequences=2)

print(f""Question: ðŸ‘¤ {question}\n"")

for i, response in  enumerate(responses):
	print(f'Response {i+1}: ðŸ¤– {tokenizer.decode(response, skip_special_tokens=True).replace(question, """")}')
```

The model will output something like:

```markdown
>>> Question: ðŸ‘¤ Qual a capital da Alemanha?

>>>Response 1: ðŸ¤– A capital da Alemanha Ã© Berlim. Ã‰ a maior cidade da Alemanha e serve como centro administrativo, cultural e polÃ­tico da Alemanha.
>>>Response 2: ðŸ¤– A capital da Alemanha Ã© Berlim. Ã‰ a maior cidade da Alemanha e serve como centro administrativo, cultural e polÃ­tico da Alemanha.
```

## Limitations

- **Hallucinations:** This model can produce content that can be mistaken for truth but is, in fact, misleading or entirely false, i.e., hallucination.

- **Biases and Toxicity:** This model inherits the social and historical stereotypes from the data used to train it. Given these biases, the model can produce toxic content, i.e., harmful, offensive, or detrimental to individuals, groups, or communities.

- **Repetition and Verbosity:** The model may get stuck on repetition loops (especially if the repetition penalty during generations is set to a meager value) or produce verbose responses unrelated to the prompt it was given.

## Cite as ðŸ¤—

```latex

@misc{nicholas22aira,
  doi = {10.5281/zenodo.6989727},
  url = {https://huggingface.co/nicholasKluge/Aira-2-portuguese-560M},
  author = {Nicholas Kluge CorrÃªa},
  title = {Aira},
  year = {2023},
  publisher = {HuggingFace},
  journal = {HuggingFace repository},
}

```

## License

Aira-2-portuguese-560M is licensed under the RAIL License since it is a model derived from BLOOM. See the [LICENSE](LICENSE) file for more details.",,,Aira-2-portuguese-560M,nicholasKluge,1,[],[],NLP,2023-06,2795193401.25,
